---
title: "Working File"
---

# Data Preparation

## Install and Launch R Packages

```{r}
#| code-fold: true
#| code-summary: "Show code"
pacman::p_load(tidyverse, readxl, knitr, dplyr, DT)
```

## Import the data

```{r}
#| code-fold: true
#| code-summary: "Show code"

attack <- read_excel("data/globalterrorismdb_0522dist.xlsx")
```

## Overview of the data

The original dataset consists of 209,706 observations and 135 variables.

### Data Structure

```{r}
#| code-fold: true
#| code-summary: "Show code"
str(attack)
```

### Data Health

There is no duplicate entries, by using `duplicate()` to check for duplicates.

```{r}
#| code-fold: true
#| code-summary: "Show code"
attack[duplicated(attack),]
```

There are 15,858,217 missing values across all columns, by using `sum(is.na())` to check for missing values.

```{r}
#| code-fold: true
#| code-summary: "Show code"
sum(is.na(attack))
```

```{r}
missing.values <- attack %>%
    gather(key = "key", value = "val") %>%
    mutate(is.missing = is.na(val)) %>%
    group_by(key, is.missing) %>%
    summarise(num.missing = n()) %>%
    filter(is.missing==T) %>%
    select(-is.missing) %>%
    arrange(desc(num.missing)) 
missing.values %>% kable()
```

```{r}
missing_values <- function(attack, vari = "country_txt"){
prepare_missing_values_graph(attack, ts_id = vari)
}
```

```{r}
missing_values(attack, "country_txt")
```

From the output below, there is no missing values from the variable *eventid*.

```{r}
#| code-fold: true
#| code-summary: "Show code"
sum(is.na(attack$eventid))
```

Given that there are many missing values across columns, we used `colsums(is.na())` to verify the columns with missing values. From the output, latitude and longitude have 4,691 and 4,692 missing values respectively. In order to ensure complete case analysis, attack events with missing values for latitude and longitude will be excluded.

```{r}
#| code-fold: true
#| code-summary: "Show code"
colSums(is.na(attack)) 
```

```{r}
#| code-fold: true
#| code-summary: "Show code"
attack_filt <- attack %>% 
  drop_na(latitude, longitude)
```

Double-check to ensure that there are no missing values in columns *latitude* and *longtitude*.

```{r}
#| code-fold: true
#| code-summary: "Show code"
sum(is.na(attack_filt$latitude))

sum(is.na(attack_filt$longitude))
```

### Unique countries

```{r}
unique(attack_filt$country_txt)
```

## Data Table

```{r}
DT::datatable(attack_filt, class = "compact")
```
